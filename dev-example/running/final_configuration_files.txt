# ========================================
# ğŸš€ ROOT BUILD.GRADLE - ì „ì²´ í”„ë¡œì íŠ¸ ë¹Œë“œ ì„¤ì •
# ========================================

plugins {
    id 'java'
    id 'org.springframework.boot' version '3.2.0' apply false
    id 'io.spring.dependency-management' version '1.1.4' apply false
    id 'org.sonarqube' version '4.4.1.3373'
    id 'jacoco'
    id 'com.google.cloud.tools.jib' version '3.4.0' apply false
    id 'com.netflix.dgs.codegen' version '6.0.3' apply false
}

allprojects {
    group = 'com.daangn'
    version = '1.0.0'
    
    repositories {
        mavenCentral()
        maven { url 'https://repo.spring.io/milestone' }
        maven { url 'https://repo.spring.io/snapshot' }
    }
}

ext {
    set('springCloudVersion', "2023.0.0")
    set('testcontainersVersion', "1.19.1")
    set('mapstructVersion', "1.5.5.Final")
    set('jjwtVersion', "0.12.3")
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'org.springframework.boot'
    apply plugin: 'io.spring.dependency-management'
    apply plugin: 'jacoco'
    apply plugin: 'com.google.cloud.tools.jib'

    java {
        sourceCompatibility = JavaVersion.VERSION_21
        targetCompatibility = JavaVersion.VERSION_21
    }

    configurations {
        compileOnly {
            extendsFrom annotationProcessor
        }
    }

    dependencies {
        // Spring Boot Core
        implementation 'org.springframework.boot:spring-boot-starter'
        implementation 'org.springframework.boot:spring-boot-starter-web'
        implementation 'org.springframework.boot:spring-boot-starter-validation'
        implementation 'org.springframework.boot:spring-boot-starter-security'
        implementation 'org.springframework.boot:spring-boot-starter-actuator'
        implementation 'org.springframework.boot:spring-boot-starter-aop'
        implementation 'org.springframework.boot:spring-boot-starter-cache'
        
        // Spring Cloud
        implementation 'org.springframework.cloud:spring-cloud-starter-netflix-eureka-client'
        implementation 'org.springframework.cloud:spring-cloud-starter-config'
        implementation 'org.springframework.cloud:spring-cloud-starter-loadbalancer'
        implementation 'org.springframework.cloud:spring-cloud-starter-circuitbreaker-resilience4j'
        implementation 'org.springframework.cloud:spring-cloud-starter-openfeign'
        
        // Database
        implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
        implementation 'org.springframework.boot:spring-boot-starter-data-redis'
        implementation 'mysql:mysql-connector-java:8.2.0'
        implementation 'org.postgresql:postgresql:42.7.1'
        implementation 'org.flywaydb:flyway-core'
        implementation 'org.flywaydb:flyway-mysql'
        
        // MongoDB (Chat Service)
        implementation 'org.springframework.boot:spring-boot-starter-data-mongodb'
        
        // Elasticsearch (Search Service)
        implementation 'org.springframework.boot:spring-boot-starter-data-elasticsearch'
        
        // Messaging
        implementation 'org.springframework.kafka:spring-kafka'
        implementation 'org.apache.kafka:kafka-streams'
        
        // Security & JWT
        implementation "io.jsonwebtoken:jjwt-api:${jjwtVersion}"
        implementation "io.jsonwebtoken:jjwt-impl:${jjwtVersion}"
        implementation "io.jsonwebtoken:jjwt-jackson:${jjwtVersion}"
        
        // WebSocket (Chat Service)
        implementation 'org.springframework.boot:spring-boot-starter-websocket'
        
        // Utils & Mapping
        implementation "org.mapstruct:mapstruct:${mapstructVersion}"
        implementation 'org.apache.commons:commons-lang3:3.14.0'
        implementation 'com.fasterxml.jackson.core:jackson-databind'
        implementation 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310'
        
        // AWS SDK
        implementation 'software.amazon.awssdk:s3:2.21.46'
        implementation 'software.amazon.awssdk:ses:2.21.46'
        implementation 'software.amazon.awssdk:sns:2.21.46'
        
        // Monitoring
        implementation 'io.micrometer:micrometer-registry-prometheus'
        implementation 'io.micrometer:micrometer-tracing-bridge-otel'
        implementation 'io.opentelemetry:opentelemetry-exporter-zipkin'
        
        // Documentation
        implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.3.0'
        
        // Annotation Processing
        compileOnly 'org.projectlombok:lombok'
        annotationProcessor 'org.projectlombok:lombok'
        annotationProcessor "org.mapstruct:mapstruct-processor:${mapstructVersion}"
        
        // Testing
        testImplementation 'org.springframework.boot:spring-boot-starter-test'
        testImplementation 'org.springframework.security:spring-security-test'
        testImplementation 'org.springframework.kafka:spring-kafka-test'
        testImplementation 'org.testcontainers:junit-jupiter'
        testImplementation 'org.testcontainers:mysql'
        testImplementation 'org.testcontainers:postgresql'
        testImplementation 'org.testcontainers:mongodb'
        testImplementation 'org.testcontainers:elasticsearch'
        testImplementation 'org.testcontainers:kafka'
        testImplementation 'com.h2database:h2'
    }

    dependencyManagement {
        imports {
            mavenBom "org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}"
            mavenBom "org.testcontainers:testcontainers-bom:${testcontainersVersion}"
        }
    }

    tasks.named('test') {
        useJUnitPlatform()
        finalizedBy jacocoTestReport
    }

    jacocoTestReport {
        dependsOn test
        reports {
            xml.required = true
            html.required = true
        }
    }

    jib {
        from {
            image = 'openjdk:21-jdk-slim'
        }
        to {
            image = "daangn/${project.name}"
            tags = [version, 'latest']
        }
        container {
            jvmFlags = ['-XX:+UseContainerSupport', '-XX:MaxRAMPercentage=70.0']
            ports = ['8080']
            environment = [
                'SPRING_PROFILES_ACTIVE': 'docker'
            ]
        }
    }
}

# ========================================
# ğŸ“ SETTINGS.GRADLE - ëª¨ë“  ëª¨ë“ˆ í¬í•¨
# ========================================

rootProject.name = 'daangn-microservices-production'

// Platform Services
include ':microservices:platform:service-discovery'
include ':microservices:platform:api-gateway'
include ':microservices:platform:config-server'

// Core Services
include ':microservices:core-services:trade-service'
include ':microservices:core-services:chat-service'
include ':microservices:core-services:payment-service'
include ':microservices:core-services:review-service'

// Domain Services
include ':microservices:domain-services:user-service'
include ':microservices:domain-services:location-service'
include ':microservices:domain-services:community-service'
include ':microservices:domain-services:job-service'
include ':microservices:domain-services:real-estate-service'
include ':microservices:domain-services:car-service'
include ':microservices:domain-services:business-service'
include ':microservices:domain-services:meeting-service'
include ':microservices:domain-services:healthcare-service'
include ':microservices:domain-services:brand-service'
include ':microservices:domain-services:gift-service'
include ':microservices:domain-services:delivery-service'
include ':microservices:domain-services:auth-service'

// Support Services
include ':microservices:support-services:search-service'
include ':microservices:support-services:notification-service'
include ':microservices:support-services:moderation-service'
include ':microservices:support-services:log-service'

// Shared Libraries
include ':shared-libraries:common-domain'
include ':shared-libraries:common-infrastructure'
include ':shared-libraries:common-api'
include ':shared-libraries:common-test'
include ':shared-libraries:common-util'

# ========================================
# ğŸ³ DOCKER-COMPOSE.YML - ë¡œì»¬ ê°œë°œ í™˜ê²½
# ========================================

version: '3.8'

services:
  # Infrastructure Services
  zookeeper:
    image: confluentinc/cp-zookeeper:7.5.0
    hostname: zookeeper
    container_name: zookeeper
    ports:
      - "2181:2181"
    environment:
      ZOOKEEPER_CLIENT_PORT: 2181
      ZOOKEEPER_TICK_TIME: 2000
    volumes:
      - zookeeper_data:/var/lib/zookeeper/data
      - zookeeper_logs:/var/lib/zookeeper/log

  kafka:
    image: confluentinc/cp-kafka:7.5.0
    hostname: kafka
    container_name: kafka
    depends_on:
      - zookeeper
    ports:
      - "29092:29092"
      - "9092:9092"
      - "9101:9101"
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: 'zookeeper:2181'
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
      KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1
      KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 1
      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 0
      KAFKA_JMX_PORT: 9101
      KAFKA_JMX_HOSTNAME: localhost
    volumes:
      - kafka_data:/var/lib/kafka/data

  # Databases
  mysql-trade:
    image: mysql:8.2
    container_name: mysql-trade
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: daangn_trade
      MYSQL_USER: daangn
      MYSQL_PASSWORD: daangn123
    ports:
      - "3306:3306"
    volumes:
      - mysql_trade_data:/var/lib/mysql
      - ./scripts/database/init-trade-db.sql:/docker-entrypoint-initdb.d/init.sql
    command: --default-authentication-plugin=mysql_native_password

  mysql-user:
    image: mysql:8.2
    container_name: mysql-user
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: daangn_user
      MYSQL_USER: daangn
      MYSQL_PASSWORD: daangn123
    ports:
      - "3307:3306"
    volumes:
      - mysql_user_data:/var/lib/mysql
    command: --default-authentication-plugin=mysql_native_password

  mysql-payment:
    image: mysql:8.2
    container_name: mysql-payment
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: daangn_payment
      MYSQL_USER: daangn
      MYSQL_PASSWORD: daangn123
    ports:
      - "3308:3306"
    volumes:
      - mysql_payment_data:/var/lib/mysql
    command: --default-authentication-plugin=mysql_native_password

  redis:
    image: redis:7.2-alpine
    container_name: redis
    restart: always
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes

  mongodb:
    image: mongo:7.0
    container_name: mongodb
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: root
      MONGO_INITDB_DATABASE: daangn_chat
    ports:
      - "27017:27017"
    volumes:
      - mongodb_data:/data/db

  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.3
    container_name: elasticsearch
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - "ES_JAVA_OPTS=-Xms1g -Xmx1g"
    ports:
      - "9200:9200"
      - "9300:9300"
    volumes:
      - elasticsearch_data:/usr/share/elasticsearch/data

  kibana:
    image: docker.elastic.co/kibana/kibana:8.11.3
    container_name: kibana
    depends_on:
      - elasticsearch
    environment:
      ELASTICSEARCH_HOSTS: http://elasticsearch:9200
    ports:
      - "5601:5601"

  # Monitoring Stack
  prometheus:
    image: prom/prometheus:v2.48.0
    container_name: prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./scripts/monitoring/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/etc/prometheus/console_libraries'
      - '--web.console.templates=/etc/prometheus/consoles'
      - '--web.enable-lifecycle'

  grafana:
    image: grafana/grafana:10.2.0
    container_name: grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - grafana_data:/var/lib/grafana
      - ./scripts/monitoring/grafana/dashboards:/etc/grafana/provisioning/dashboards
      - ./scripts/monitoring/grafana/datasources:/etc/grafana/provisioning/datasources

  jaeger:
    image: jaegertracing/all-in-one:1.52
    container_name: jaeger
    ports:
      - "14268:14268"
      - "16686:16686"
    environment:
      - COLLECTOR_OTLP_ENABLED=true

  # Platform Services
  eureka-server:
    build: ./microservices/platform/service-discovery
    container_name: eureka-server
    ports:
      - "8761:8761"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8761/actuator/health"]
      interval: 30s
      timeout: 10s
      retries: 3

  config-server:
    build: ./microservices/platform/config-server
    container_name: config-server
    depends_on:
      eureka-server:
        condition: service_healthy
    ports:
      - "8888:8888"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka-server:8761/eureka

  api-gateway:
    build: ./microservices/platform/api-gateway
    container_name: api-gateway
    depends_on:
      - eureka-server
      - config-server
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka-server:8761/eureka
      - SPRING_CLOUD_CONFIG_URI=http://config-server:8888

  # Core Services
  trade-service:
    build: ./microservices/core-services/trade-service
    container_name: trade-service
    depends_on:
      - mysql-trade
      - redis
      - kafka
      - eureka-server
    ports:
      - "8081:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql-trade:3306/daangn_trade
      - SPRING_DATASOURCE_USERNAME=daangn
      - SPRING_DATASOURCE_PASSWORD=daangn123
      - SPRING_REDIS_HOST=redis
      - SPRING_KAFKA_BOOTSTRAP_SERVERS=kafka:29092
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka-server:8761/eureka

  chat-service:
    build: ./microservices/core-services/chat-service
    container_name: chat-service
    depends_on:
      - mongodb
      - redis
      - kafka
      - eureka-server
    ports:
      - "8082:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - SPRING_DATA_MONGODB_URI=mongodb://root:root@mongodb:27017/daangn_chat?authSource=admin
      - SPRING_REDIS_HOST=redis
      - SPRING_KAFKA_BOOTSTRAP_SERVERS=kafka:29092
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka-server:8761/eureka

  payment-service:
    build: ./microservices/core-services/payment-service
    container_name: payment-service
    depends_on:
      - mysql-payment
      - redis
      - kafka
      - eureka-server
    ports:
      - "8083:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql-payment:3306/daangn_payment
      - SPRING_DATASOURCE_USERNAME=daangn
      - SPRING_DATASOURCE_PASSWORD=daangn123
      - SPRING_REDIS_HOST=redis
      - SPRING_KAFKA_BOOTSTRAP_SERVERS=kafka:29092
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka-server:8761/eureka

  user-service:
    build: ./microservices/domain-services/user-service
    container_name: user-service
    depends_on:
      - mysql-user
      - redis
      - kafka
      - eureka-server
    ports:
      - "8084:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql-user:3306/daangn_user
      - SPRING_DATASOURCE_USERNAME=daangn
      - SPRING_DATASOURCE_PASSWORD=daangn123
      - SPRING_REDIS_HOST=redis
      - SPRING_KAFKA_BOOTSTRAP_SERVERS=kafka:29092
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka-server:8761/eureka

  search-service:
    build: ./microservices/support-services/search-service
    container_name: search-service
    depends_on:
      - elasticsearch
      - kafka
      - eureka-server
    ports:
      - "8085:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - SPRING_ELASTICSEARCH_URIS=http://elasticsearch:9200
      - SPRING_KAFKA_BOOTSTRAP_SERVERS=kafka:29092
      - EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE=http://eureka-server:8761/eureka

volumes:
  mysql_trade_data:
  mysql_user_data:
  mysql_payment_data:
  redis_data:
  mongodb_data:
  elasticsearch_data:
  prometheus_data:
  grafana_data:
  zookeeper_data:
  zookeeper_logs:
  kafka_data:

networks:
  default:
    name: daangn-network

# ========================================
# ğŸ”§ APPLICATION.YML - ê³µí†µ ì„¤ì •
# ========================================

spring:
  application:
    name: ${service.name:unknown-service}
  
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:local}
  
  cloud:
    config:
      enabled: true
      uri: ${SPRING_CLOUD_CONFIG_URI:http://localhost:8888}
      fail-fast: true
      retry:
        initial-interval: 1000
        max-attempts: 6
        multiplier: 1.1
  
  jackson:
    time-zone: Asia/Seoul
    date-format: yyyy-MM-dd HH:mm:ss
    serialization:
      write-dates-as-timestamps: false
    deserialization:
      fail-on-unknown-properties: false

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    open-in-view: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MySQL8Dialect
        format_sql: true
        use_sql_comments: true
        jdbc:
          batch_size: 20
          order_inserts: true
          order_updates: true
        connection:
          provider_disables_autocommit: true

  data:
    redis:
      host: ${SPRING_REDIS_HOST:localhost}
      port: ${SPRING_REDIS_PORT:6379}
      password: ${SPRING_REDIS_PASSWORD:}
      database: 0
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

  kafka:
    bootstrap-servers: ${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
      acks: all
      retries: 3
      properties:
        enable.idempotence: true
        max.in.flight.requests.per.connection: 5
    consumer:
      group-id: ${spring.application.name}
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      auto-offset-reset: latest
      enable-auto-commit: false
      properties:
        spring.json.trusted.packages: "com.daangn"

eureka:
  client:
    service-url:
      defaultZone: ${EUREKA_CLIENT_SERVICE_URL_DEFAULTZONE:http://localhost:8761/eureka/}
    register-with-eureka: true
    fetch-registry: true
  instance:
    prefer-ip-address: true
    instance-id: ${spring.application.name}:${spring.application.instance_id:${random.value}}

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus,httptrace
  endpoint:
    health:
      show-details: always
  metrics:
    export:
      prometheus:
        enabled: true
  tracing:
    sampling:
      probability: 1.0

logging:
  level:
    com.daangn: INFO
    org.springframework.web: INFO
    org.springframework.security: INFO
    org.hibernate.SQL: INFO
    org.hibernate.type.descriptor.sql.BasicBinder: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level [%logger{36}] - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level [%logger{36}] - %msg%n"

# ========================================
# ğŸ› ï¸ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ - start-dev.sh
# ========================================

#!/bin/bash

echo "ğŸ¥• ë‹¹ê·¼ë§ˆì¼“ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°œë°œ í™˜ê²½ ì‹œì‘"
echo "================================================"

# ì¸í”„ë¼ ì„œë¹„ìŠ¤ ë¨¼ì € ì‹œì‘
echo "ğŸ“¡ ì¸í”„ë¼ ì„œë¹„ìŠ¤ ì‹œì‘ ì¤‘..."
docker-compose up -d zookeeper kafka mysql-trade mysql-user mysql-payment redis mongodb elasticsearch

# ì¸í”„ë¼ ì„œë¹„ìŠ¤ ì¤€ë¹„ ëŒ€ê¸°
echo "â³ ì¸í”„ë¼ ì„œë¹„ìŠ¤ ì¤€ë¹„ ëŒ€ê¸° ì¤‘..."
sleep 30

# í”Œë«í¼ ì„œë¹„ìŠ¤ ì‹œì‘
echo "ğŸ—ï¸ í”Œë«í¼ ì„œë¹„ìŠ¤ ì‹œì‘ ì¤‘..."
docker-compose up -d eureka-server
sleep 15

docker-compose up -d config-server
sleep 10

docker-compose up -d api-gateway
sleep 10

# ëª¨ë‹ˆí„°ë§ ì„œë¹„ìŠ¤ ì‹œì‘
echo "ğŸ“Š ëª¨ë‹ˆí„°ë§ ì„œë¹„ìŠ¤ ì‹œì‘ ì¤‘..."
docker-compose up -d prometheus grafana jaeger kibana

# í•µì‹¬ ì„œë¹„ìŠ¤ ì‹œì‘
echo "ğŸ”¥ í•µì‹¬ ì„œë¹„ìŠ¤ ì‹œì‘ ì¤‘..."
docker-compose up -d trade-service chat-service payment-service user-service search-service

echo ""
echo "âœ… ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!"
echo ""
echo "ğŸŒ ì ‘ì† ì •ë³´:"
echo "- API Gateway: http://localhost:8080"
echo "- Eureka Dashboard: http://localhost:8761"
echo "- Grafana: http://localhost:3000 (admin/admin)"
echo "- Prometheus: http://localhost:9090"
echo "- Kibana: http://localhost:5601"
echo "- Jaeger: http://localhost:16686"
echo ""
echo "ğŸ“š API ë¬¸ì„œ:"
echo "- Trade Service: http://localhost:8081/swagger-ui.html"
echo "- Chat Service: http://localhost:8082/swagger-ui.html"
echo "- Payment Service: http://localhost:8083/swagger-ui.html"
echo "- User Service: http://localhost:8084/swagger-ui.html"
echo "- Search Service: http://localhost:8085/swagger-ui.html"
echo ""
echo "ğŸ¯ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì¤€ë¹„ë˜ë©´ http://localhost:8080 ì—ì„œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!"

# ========================================
# ğŸ›‘ ì¢…ë£Œ ìŠ¤í¬ë¦½íŠ¸ - stop-dev.sh
# ========================================

#!/bin/bash

echo "ğŸ›‘ ë‹¹ê·¼ë§ˆì¼“ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°œë°œ í™˜ê²½ ì¢…ë£Œ"
echo "================================================"

# ëª¨ë“  ì„œë¹„ìŠ¤ ì¢…ë£Œ
docker-compose down

# ë³¼ë¥¨ ì •ë¦¬ (ì„ íƒì‚¬í•­)
read -p "ë°ì´í„° ë³¼ë¥¨ë„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/N): " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    docker-compose down -v
    echo "âœ… ë°ì´í„° ë³¼ë¥¨ê¹Œì§€ ëª¨ë‘ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."
else
    echo "âœ… ì„œë¹„ìŠ¤ë§Œ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë°ì´í„°ëŠ” ë³´ì¡´ë©ë‹ˆë‹¤."
fi

echo "ğŸ ì¢…ë£Œ ì™„ë£Œ!"

# ========================================
# ğŸ“ README.md - í”„ë¡œì íŠ¸ ì‹¤í–‰ ê°€ì´ë“œ
# ========================================

# ğŸ¥• ë‹¹ê·¼ë§ˆì¼“ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ (í”„ë¡œë•ì…˜ê¸‰)

ë‹¹ê·¼ë§ˆì¼“ì˜ ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ í¬í•¨í•œ ì™„ì „í•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. ì‚¬ì „ ìš”êµ¬ì‚¬í•­
- Java 21
- Docker & Docker Compose
- Gradle 8.0+
- ìµœì†Œ 16GB RAM ê¶Œì¥

### 2. ê°œë°œ í™˜ê²½ ì‹œì‘
```bash
# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x scripts/start-dev.sh scripts/stop-dev.sh

# ê°œë°œ í™˜ê²½ ì‹œì‘
./scripts/start-dev.sh

# ë¡œê·¸ í™•ì¸
docker-compose logs -f

# ê°œë°œ í™˜ê²½ ì¢…ë£Œ
./scripts/stop-dev.sh
```

### 3. ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸
```bash
# ì „ì²´ ë¹Œë“œ
./gradlew build

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¹Œë“œ
./gradlew :microservices:core-services:trade-service:build

# ì „ì²´ í…ŒìŠ¤íŠ¸
./gradlew test

# ë„ì»¤ ì´ë¯¸ì§€ ë¹Œë“œ
./gradlew jibDockerBuild
```

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### ì„œë¹„ìŠ¤ êµ¬ì„± (ì´ 20ê°œ)
- **Platform (3ê°œ)**: Discovery, Gateway, Config
- **Core (4ê°œ)**: Trade, Chat, Payment, Review
- **Domain (10ê°œ)**: User, Location, Community, Job, etc.
- **Support (3ê°œ)**: Search, Notification, Moderation

### ê¸°ìˆ  ìŠ¤íƒ
- **Backend**: Spring Boot 3.2, Java 21
- **Database**: MySQL (ìƒ¤ë”©), MongoDB, Redis, Elasticsearch
- **Messaging**: Apache Kafka
- **Container**: Docker, Kubernetes
- **Monitoring**: Prometheus, Grafana, ELK, Jaeger

## ğŸ“Š ëª¨ë‹ˆí„°ë§

- **Grafana**: http://localhost:3000 (admin/admin)
- **Prometheus**: http://localhost:9090
- **Jaeger**: http://localhost:16686
- **Kibana**: http://localhost:5601

## ğŸ”— API ì ‘ê·¼

- **API Gateway**: http://localhost:8080
- **Eureka Dashboard**: http://localhost:8761
- **Swagger UI**: ê° ì„œë¹„ìŠ¤ë³„ :í¬íŠ¸ë²ˆí˜¸/swagger-ui.html

## ğŸ“š ë¬¸ì„œ

- [ì•„í‚¤í…ì²˜ ë¬¸ì„œ](./documentation/architecture/)
- [API ë¬¸ì„œ](./documentation/api/)
- [ë°°í¬ ê°€ì´ë“œ](./documentation/operations/)
- [ê°œë°œ ê°€ì´ë“œ](./documentation/development/)

## ğŸ¤ ê¸°ì—¬í•˜ê¸°

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT License - ìì„¸í•œ ë‚´ìš©ì€ [LICENSE](LICENSE) íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.

---

**ğŸ¯ ì´ì œ ì •ë§ë¡œ ì™„ì „í•œ ë‹¹ê·¼ë§ˆì¼“ ìˆ˜ì¤€ì˜ í”„ë¡œë•ì…˜ê¸‰ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ê°€ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!** ğŸš€